- nmap => Network Mapper, is a network scanner, used to identifiying live hosts, services running on these hosts, also uses scripts to exploit vulns
- there are three ways nmap uses to discover live hosts:
	1. ARP scan => this scan uses ARP requests to identify live hosts
	2. ICMP scan => this scan uses iCMP requests to identify live hosts
	3. TCP/UDP ping scan => this scsan uses TCP & UDP requests to identifi live hosts

- Nmap scan walk through:
	1. Enumeration targets
	2. Discover live hosts
	3. reverse DNS-lookup
	4. scan ports
	5. detect versions
	6. detect OS
	7. traceroute
	8. scripts
	9. write output

- Network segement VS Subnetwok: 
	Network segment => a group of computers connected used shared mediam like the ethernet switch, wifi access point, its a physical connection

	Subnet => is the equivalet of one or more network segements configured to use the same router, logical connection

- subnets with /16 refers to 255.255.0.0
- subnets with /24 refers to 255.255.255.0 

- while scnning for live hosts, you can scan:
		1. list of targets `ip google.com yahoo.com`
		2. range of ips `10.10.10.12-25` 
		3. file list `nmap -iL Targets.txt`
		4. subnet `10.10.10.12/24`
 -sL => list of possiible IPs in thie range or subnets
 -n  => prevent dns reversing

 - according to TCP/IP model:
 	ARP => Data link layer
 	ICMP  => Network layeyr
 	TCP & UDP => Transport 

- what do these protocols do?
	1. ARP => Send a packet using the broadcat address asking the device with a specific IP address to respond by provideing its MAC address.
	2. ICMP => has many types, ICMP ping uses type 8 (Echo) and type 0 (Echo Reply)
- If you want to ping a system on the same subnet, an ARP query should precede the ICMP Echo
- by default nmap uses ping scan to find live hosts, then scans only the live hosts.
- using nmap to discover live hosts without port scanning => `nmap -sn targets`
- arp scan => `nmap -PR -sn targets`
- -PR => only ARP scan
- you can use arp scan only with devices in the local network, or on the whole local network
- arp-scan tool can be used to make arp scan in the local network `arp-scan localnet`
- in short, we use ARP scan withen the local network


# ICMP scan => is just ICMP echo request (type 8) & ICMP echo reply (type 0) => `nmap -PE -sn targets`
- if you rtiedd to make an ICMP scan for the localnetwork, the nmap will make it using the ARP scan, and returnn back in the output the MAC of the up hosts

- Because ICMP echo requests tend to be blocked, you might also consider ICMP Timestamp or ICMP Address Mask requests to tell if a system is online.
# ICMP timestamp scan => you send a timestamo request(type 13) annd the target reply with a timestamp reply(type 14), using -PP

# ICMP address mask scan, reauest(type 17), reply (type 18) => -PM

- in short, the ICMP scan:
	1. ICMP Echo 
	2. ICMP timestamp
	3. ICMP mask address scan

========================================
- TCP & UDP Scan
----------------
1. TCP SYN Pign => using three way handshake, by sending SYN packet, if the host is up , a SYN/ACK packet would be recieved.
- note that is the port is closed, the response would be RST packet.
- HOW to make TCP SYN scan?
	-PS21 => port number
	-PS21-25 => range
	-PS80, 443, 8080 => scecific ports
- by default TCP SYN scan uses prot 80
- Privileged users (root and sudoers) can send TCP SYN packets and don’t need to complete the TCP 3-way handshake even if the port is open, as shown in the figure below. Unprivileged users have no choice but to complete the 3-way handshake if the port is open. 
 => the image `https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/168d48701c5f872cf1930e08b32bcd6f.png`<=
===========================================
2. TCP ACK Ping
 the image `https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/db5ab44a8c700c4ab0603e85e456040d.png`

	- this scan just works for root or sudors , you send an TCP ACK packet and expected to receive a RST packet as the image above
- HOW to make TCP ACK Scan?
	-PA21 => port number
	-PA21-25 => range
	-PA80, 443, 8080 => scecific ports
- by default TCP ACK scan uses prot 80
============================================
3. UDP PING SCAN
	- when sending an UDP packet we do not expect to get any reply, 
	but if the port is closed when we send a UDP packet, the target would reply with ICMP port unreachable packet(type 3), this means the host is up.
- note that UDP scan is useful only if you send a packet withen a closed port
- HOW to make UDP scan?
	-PU
-by default Nmap uses an uncommon UDP port to trigger an ICMP destination unreachable (port unreachable) error.
=============================================
=>Masscan<=

masscan MACHINE_IP/24 -p443
masscan MACHINE_IP/24 -p80,443
masscan MACHINE_IP/24 -p22-25
masscan MACHINE_IP/24 ‐‐top-ports 100
=============================================

-NOTE:
	Nmap’s default behaviour is to use reverse-DNS online hosts. Because the hostnames can reveal a lot, this can be a helpful step. However, if you don’t want to send such DNS queries, you use -n to skip this step.

	By default, Nmap will look up online hosts; however, you can use the option -R to query the DNS server even for offline hosts. If you want to use a specific DNS server, you can add the --dns-servers DNS_SERVER option.
----------------------------------------------------
-PA => ARP scan
-PE => ICMP Echo scan
-PM => ICMP Timestamp scann
-PP => ICMP Address Mask Scan
-PS => TCP SYN Ping Scan
-PA TCP ACK Ping Scan
-PU => UDP Ping Scan
----------------------------------------------------
-n => No DNS lookup
-R => Revers DNS lookip for all hosts
-sn => Host discovery only


=====================
	Alhamdullah
=====================